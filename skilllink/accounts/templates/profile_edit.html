{% extends "base.html" %}
{% load static %}

{% block title %}Edit Profile - SkillLink{% endblock %}

{% block content %}
<div class="container my-5">

  <!-- Header -->
  <h2 class="text-center fw-bold mb-4 animate__animated animate__fadeInDown page-title">
    ✏️ Edit Profile
  </h2>

  <!-- Profile Info Card -->
  <div class="card shadow-lg edit-profile-card animate__animated animate__fadeInUp">
    <div class="card-body">
      <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        {% for field in profile_form %}
        <div class="mb-3 reveal">
          <label class="fw-semibold">{{ field.label }}</label>
          {{ field }}
          {% for error in field.errors %}
          <div class="text-danger small">{{ error }}</div>
          {% endfor %}
        </div>
        {% endfor %}
        <div class="text-center mt-4">
          <button type="submit" class="btn btn-warning text-dark fw-bold px-5 py-2 shadow-sm hover-grow">
            Save Profile
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Skills Section -->
  <div class="card shadow-lg skill-list-card animate__animated animate__fadeInUp animate__delay-1s mt-5">
    <div class="card-header d-flex justify-content-between align-items-center fw-bold header-style">
      <h5 class="mb-0">My Skills</h5>
      <a href="{% url 'add_skill' %}" class="btn btn-dark btn-sm fw-bold shadow-sm hover-grow">+ Add Skill</a>
    </div>

    <div class="card-body">
      {% if skills %}
      <ul class="list-group list-group-flush">
        {% for skill in skills %}
        <li class="list-group-item d-flex justify-content-between align-items-center skill-item reveal">
          <div>
            {% if skill.skill.skill_icon %}
            <img src="{{ skill.skill.skill_icon.url }}" alt="{{ skill.skill.name }}" class="rounded me-2"
              style="width:32px; height:32px;">
            {% endif %}
            <strong>{{ skill.skill.name }}</strong>
            <span class="badge bg-info text-dark ms-2">{{ skill.get_experience_level_display }}</span>
            <p class="text-muted mb-0">{{ skill.personal_description|default:"No description" }}</p>
          </div>
          <div class="btn-group btn-group-sm">
            <a href="{% url 'edit_skill' skill.id %}" class="btn btn-outline-primary shadow-sm">Edit</a>
            <a href="{% url 'delete_skill' skill.id %}" class="btn btn-outline-danger shadow-sm"
              onclick="return confirm('Are you sure?');">Delete</a>
          </div>
        </li>
        {% endfor %}
      </ul>
      {% else %}
      <p class="text-muted text-center mb-0">No skills added yet. Click <strong>"Add Skill"</strong> to get started.</p>
      {% endif %}
    </div>
  </div>
</div>

<!-- Animate.css -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />

<style>

  .edit-profile-card,
  .skill-list-card {
    border-radius: 1.5rem;
    background: #ffffff;
    border: 1px solid rgba(0, 0, 0, 0.05);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
  }

  .edit-profile-card:hover,
  .skill-list-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
  }


  body.dark-mode {
    background-color: #000000 !important;
    color: #f1f5f9;
  }

  body.dark-mode .edit-profile-card,
  body.dark-mode .skill-list-card {
    background: #1A1A1A;
    color: #f1f5f9;
    border: 1px solid #333;
    box-shadow: 0 4px 6px rgba(255, 255, 255, 0.05);
  }


  .header-style {
    background-color: #fef3c7;
    color: #b45309;
    border-top-left-radius: 1.5rem !important;
    border-top-right-radius: 1.5rem !important;
    padding: 1.5rem;
  }

  body.dark-mode .header-style {
    background-color: #333;
    color: #f59e0b;
    border-bottom: 1px solid #444;
  }

  .edit-profile-card input,
  .edit-profile-card textarea,
  .edit-profile-card select {
    border-radius: 0.5rem !important;
    border: 1px solid #cbd5e1 !important;
    padding: 0.75rem !important;
    transition: all 0.3s ease;
    background-color: #fff;
    color: #1e293b;
    width: 100%;
  }

  .edit-profile-card input:focus,
  .edit-profile-card textarea:focus,
  .edit-profile-card select:focus {
    border-color: #f59e0b !important;
    box-shadow: 0 0 0 4px rgba(245, 158, 11, 0.1) !important;
    outline: none;
  }

  body.dark-mode .edit-profile-card input,
  body.dark-mode .edit-profile-card textarea,
  body.dark-mode .edit-profile-card select {
    background-color: #222 !important;
    border-color: #444 !important;
    color: #f1f5f9 !important;
  }

  body.dark-mode .edit-profile-card input:focus,
  body.dark-mode .edit-profile-card textarea:focus,
  body.dark-mode .edit-profile-card select:focus {
    border-color: #f59e0b !important;
    background-color: #2a2a2a !important;
  }


  body.dark-mode input[type="file"]::-webkit-file-upload-button,
  body.dark-mode input[type="file"]::file-selector-button {
    background-color: #333;
    color: #e2e8f0;
    border: 1px solid #444;
    border-radius: 0.5rem;
    margin-right: 1rem;
    padding: 0.5rem 1rem;
    transition: all 0.3s ease;
  }

  body.dark-mode input[type="file"]:hover::-webkit-file-upload-button,
  body.dark-mode input[type="file"]:hover::file-selector-button {
    background-color: #f59e0b;
    color: #111;
    border-color: #f59e0b;
    cursor: pointer;
  }


  .edit-profile-card .btn-warning {
    background: linear-gradient(135deg, #f59e0b, #d97706);
    border: none;
    color: white !important;
    border-radius: 50rem;
  }

  .edit-profile-card .btn-warning:hover {
    background: linear-gradient(135deg, #fbbf24, #b45309);
    transform: scale(1.05);
    box-shadow: 0 4px 15px rgba(245, 158, 11, 0.3);
  }

  .hover-grow {
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }

  .skill-item {
    transition: background-color 0.3s ease, transform 0.2s ease;
    border-radius: 0.75rem;
    padding: 1rem;
    border-bottom: 1px solid rgba(0, 0, 0, 0.05);
  }

  .skill-item:last-child {
    border-bottom: none;
  }

  .skill-item:hover {
    background-color: #f8fafc;
    transform: translateX(5px);
  }

  body.dark-mode .skill-item {
    border-bottom: 1px solid #333;
  }

  body.dark-mode .skill-item:hover {
    background-color: #222;
  }


  body.dark-mode .list-group-item {
    background-color: transparent;
    border-color: #333;
    color: #e2e8f0;
  }

  body.dark-mode .list-group-item .text-muted {
    color: #a3a3a3 !important;
  }


  .page-title {
    color: #1e293b;
    font-weight: 800;
  }

  body.dark-mode .page-title {
    color: #f1f5f9;
  }

  body.dark-mode label {
    color: #e2e8f0;
  }

  body.dark-mode strong {
    color: #f1f5f9;
  }


  @media (max-width: 768px) {

    .edit-profile-card,
    .skill-list-card {
      padding: 1.5rem;
    }

    .page-title {
      font-size: 1.6rem;
    }
  }
</style>


<script>
  document.addEventListener("DOMContentLoaded", () => {
    const reveals = document.querySelectorAll(".reveal");
    const revealOnScroll = () => {
      const trigger = window.innerHeight * 0.85;
      reveals.forEach(el => {
        const top = el.getBoundingClientRect().top;
        if (top < trigger) el.classList.add("animate__animated", "animate__fadeInUp");
      });
    };
    window.addEventListener("scroll", revealOnScroll);
    revealOnScroll();
  });
</script>
{% endblock %}